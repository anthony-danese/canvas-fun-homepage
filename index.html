<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matter.js Bouncing Interactive Letters</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #f0f0f0;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.17.1/matter.min.js"></script>
<script>
    // Module aliases
    const Engine = Matter.Engine,
          Render = Matter.Render,
          Runner = Matter.Runner,
          Bodies = Matter.Bodies,
          Composite = Matter.Composite,
          Mouse = Matter.Mouse,
          MouseConstraint = Matter.MouseConstraint,
          Body = Matter.Body;

    // Create engine and renderer
    const engine = Engine.create();

    const render = Render.create({
        element: document.body,
        engine: engine,
        options: {
            width: window.innerWidth,
            height: window.innerHeight,
            wireframes: false,
            background: '#ffffff'
        }
    });

    Render.run(render);
    const runner = Runner.create();
    Runner.run(runner, engine);

    // Create boundaries
    const width = render.options.width;
    const height = render.options.height;

    const walls = [
        Bodies.rectangle(width / 2, height + 30, width + 100, 60, { isStatic: true }), // ground
        Bodies.rectangle(-30, height / 2, 60, height, { isStatic: true }), // left wall
        Bodies.rectangle(width + 30, height / 2, 60, height, { isStatic: true }), // right wall
        Bodies.rectangle(width / 2, -30, width + 100, 60, { isStatic: true }) // ceiling
    ];
    Composite.add(engine.world, walls);

    // Generate a random hex color
    function getRandomColor() {
        return '#' + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0');
    }

    // Create a canvas texture with a single letter
    function createTextTexture(text, color, size, family) {
        const canvas = document.createElement("canvas");
        const ctx = canvas.getContext("2d");
        ctx.font = "bold " + size + "px " + family;
        const textWidth = ctx.measureText(text).width;
        canvas.width = textWidth;
        canvas.height = size;

        ctx.font = "bold " + size + "px " + family;
        ctx.fillStyle = color;
        ctx.fillText(text, 0, size * 0.8); // vertically centered

        return canvas.toDataURL("image/png");
    }

    // Create a physical body for a letter
    function createLetter(letter, x, y) {
        if (letter === ' ') return null; // skip spaces

        const size = 64;
        const font = "Arial, sans-serif";
        const color = getRandomColor();

        // Measure text width
        const tempCanvas = document.createElement("canvas");
        const tempCtx = tempCanvas.getContext("2d");
        tempCtx.font = "bold " + size + "px " + font;
        const textWidth = tempCtx.measureText(letter).width;
        const textHeight = size;

        const body = Bodies.rectangle(x, y, textWidth, textHeight, {
            restitution: 0.8,
            friction: 0.2,
            render: {
                sprite: {
                    texture: createTextTexture(letter, color, size, font),
                    xScale: 1,
                    yScale: 1
                }
            }
        });

        return body;
    }

    // Add letters
    const text = "Mr. Danese";
    const spacing = 50;
    const startX = 100;
    const startY = 100;

    text.split('').forEach((char, i) => {
        const letterBody = createLetter(char, startX + i * spacing, startY);
        if (letterBody) {
            Composite.add(engine.world, letterBody);
        }
    });

    // Mouse interaction
    const mouse = Mouse.create(render.canvas);
    const mouseConstraint = MouseConstraint.create(engine, {
        mouse: mouse,
        constraint: {
            stiffness: 0.2,
            render: {
                visible: false
            }
        }
    });
    Composite.add(engine.world, mouseConstraint);
    render.mouse = mouse;

    // Optional: Toggle gravity with 'G'
    document.addEventListener("keydown", function(event) {
        if (event.key.toLowerCase() === 'g') {
            engine.world.gravity.y = engine.world.gravity.y === 0 ? 1 : 0;
        }
    });

    // Handle window resize (optional)
    window.addEventListener('resize', () => {
        location.reload(); // Reload the page to reinitialize sizes
    });

</script>
</body>
</html>
