<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matter.js Bouncing Interactive Letters</title>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; background: #fff; }
        canvas { display: block; }
    </style>
</head>
<body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.17.1/matter.min.js"></script>
<script>
    const Engine = Matter.Engine,
          Render = Matter.Render,
          Runner = Matter.Runner,
          Bodies = Matter.Bodies,
          Composite = Matter.Composite,
          Mouse = Matter.Mouse,
          MouseConstraint = Matter.MouseConstraint;

    const engine = Engine.create();
    const render = Render.create({
        element: document.body,
        engine: engine,
        options: {
            width: window.innerWidth,
            height: window.innerHeight,
            wireframes: false,
            background: '#ffffff'
        }
    });

    Render.run(render);
    Runner.run(Runner.create(), engine);

    // Boundaries (no visible ground/platform)
    const width = render.options.width;
    const height = render.options.height;

    // Invisible ground (objects bounce, but no platform is shown)
    const invisibleGround = Bodies.rectangle(width / 2, height + 30, width + 100, 60, { 
        isStatic: true, 
        render: { visible: false }
    });

    const leftWall = Bodies.rectangle(-30, height / 2, 60, height, { isStatic: true });
    const rightWall = Bodies.rectangle(width + 30, height / 2, 60, height, { isStatic: true });
    const ceiling = Bodies.rectangle(width / 2, -30, width + 100, 60, { isStatic: true });

    // Only add invisible ground, left/right walls, and ceiling
    Composite.add(engine.world, [invisibleGround, leftWall, rightWall, ceiling]);

    // Utility functions
    function getRandomColor() {
        return '#' + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0');
    }
    function createTextTexture(text, color, size, family) {
        const canvas = document.createElement("canvas");
        const ctx = canvas.getContext("2d");
        ctx.font = "bold " + size + "px " + family;
        const textWidth = ctx.measureText(text).width;
        canvas.width = textWidth;
        canvas.height = size;
        ctx.font = "bold " + size + "px " + family;
        ctx.fillStyle = color;
        ctx.fillText(text, 0, size * 0.8);
        return canvas.toDataURL("image/png");
    }
    function createLetter(letter, x, y, size=100, font="Arial, sans-serif") {
        if (letter === ' ') return null;
        const color = getRandomColor();
        const tempCanvas = document.createElement("canvas");
        const tempCtx = tempCanvas.getContext("2d");
        tempCtx.font = "bold " + size + "px " + font;
        const textWidth = tempCtx.measureText(letter).width;
        const textHeight = size;
        return Bodies.rectangle(x, y, textWidth, textHeight, {
            restitution: 0.8,
            friction: 0.2,
            render: {
                sprite: {
                    texture: createTextTexture(letter, color, size, font),
                    xScale: 1,
                    yScale: 1
                }
            }
        });
    }

    // Spacing and font
    let letterSpacing = 48;
    let fontSize = 100; // font size set to 100

    // "iSTEM" - STEM first, then "i"
    let text = "iSTEM";
    let letters = text.split('');
    let stemLetters = letters.slice(1); // ['S','T','E','M']
    let iLetter = letters[0]; // 'i'

    let lineX = width / 2;
    let lineY = height / 2;
    let totalWidth = (stemLetters.length - 1) * letterSpacing;
    let startX = lineX - totalWidth / 2;
    let y = lineY - 70;

    // Add STEM letters immediately
    let stemBodies = [];
    stemLetters.forEach((char, idx) => {
        let x = startX + idx * letterSpacing;
        let letterBody = createLetter(char, x, y, fontSize);
        stemBodies.push(letterBody);
        if (letterBody) Composite.add(engine.world, letterBody);
    });

    // Add "i" after a few seconds (e.g., 2 seconds)
    setTimeout(() => {
        let iX = lineX - (totalWidth / 2) - letterSpacing-5; // Place to left of STEM
        let iBody = createLetter(iLetter, iX, y, fontSize);
        if (iBody) Composite.add(engine.world, iBody);
    }, 2000);

    // Mouse interaction
    const mouse = Mouse.create(render.canvas);
    const mouseConstraint = MouseConstraint.create(engine, {
        mouse: mouse,
        constraint: {
            stiffness: 0.2,
            render: { visible: false }
        }
    });
    Composite.add(engine.world, mouseConstraint);
    render.mouse = mouse;

    // Toggle gravity with 'G'
    document.addEventListener("keydown", function(event) {
        if (event.key.toLowerCase() === 'g') {
            engine.world.gravity.y = engine.world.gravity.y === 0 ? 1 : 0;
        }
    });

    // Handle window resize
    window.addEventListener('resize', () => {
        location.reload();
    });
</script>
</body>
</html>
